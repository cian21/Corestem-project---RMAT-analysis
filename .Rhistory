ALSFRSR_file_allo_P12_FCSPMM$Changes = ALSFRSR_file_allo_P12_FCSPMM$M12 - ALSFRSR_file_allo_P12_FCSPMM$M0
save.image(file = "./Data/ALS RMAT analysis files.image")
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
#### 2. simple LOCF running ####
ALSFRSR_file_allo_P12_LOCF = LOCF_table_run(ALSFRSR_file_allo_P12)
ALSFRSR_file_allo_P2cont_LOCF = LOCF_table_run(ALSFRSR_file_allo_P2cont)
stat_allo_P12 = stat_table_run(ALSFRSR_file_allo_P12)
stat_allo_P2cont = stat_table_run(ALSFRSR_file_allo_P2cont)
stat_allo_P12_LOCF = stat_table_run(ALSFRSR_file_allo_P12_LOCF)
stat_allo_P2cont_LOCF = stat_table_run(ALSFRSR_file_allo_P2cont_LOCF)
stat_allo_P12_FCSPMM = stat_table_run(ALSFRSR_file_allo_P12_FCSPMM)
stat_bind = cbind(stat_allo_P12,
stat_allo_P12_LOCF$pvalue,
stat_allo_P2cont$pvalue,
stat_allo_P2cont_LOCF$pvalue,
stat_allo_P12_FCSPMM$pvalue)
colnames(stat_bind) = c("TEST",
"P12_Allo",
"P12_Allo_LOCF",
"P2CONT_Allo",
"P2CONT_Allo_LOCF",
"P12_FCSPMM")
View(stat_bind)
stat_table_run(ALSFRSR_file_allo_P12_FCSPMM[1:66,])
#### 2. Files Loading ####
ALSFRSR_file = "./Data/Rawdata/Allo 및 임상 12상 통합자료.xlsx"
ALSFRSR_file_allo_P2cont = read_xlsx(ALSFRSR_file, sheet = 3)
ALSFRSR_file_allo_P12 = read_xlsx(ALSFRSR_file, sheet = 4)
ALSFRSR_file_allo_P12_FCSPMM = read_xlsx(ALSFRSR_file, sheet = 5)
save.image(file = "./Data/ALS RMAT analysis files.image")
ALSFRSR_file_allo_P12$Changes = ALSFRSR_file_allo_P12$M12 - ALSFRSR_file_allo_P12$M0
ALSFRSR_file_allo_P2cont$Changes = ALSFRSR_file_allo_P2cont$M12 - ALSFRSR_file_allo_P2cont$M0
ALSFRSR_file_allo_P12_FCSPMM$Changes = ALSFRSR_file_allo_P12_FCSPMM$M12 - ALSFRSR_file_allo_P12_FCSPMM$M0
save.image(file = "./Data/ALS RMAT analysis files.image")
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
#### 2. simple LOCF running ####
ALSFRSR_file_allo_P12_LOCF = LOCF_table_run(ALSFRSR_file_allo_P12)
ALSFRSR_file_allo_P2cont_LOCF = LOCF_table_run(ALSFRSR_file_allo_P2cont)
stat_allo_P12 = stat_table_run(ALSFRSR_file_allo_P12)
stat_allo_P2cont = stat_table_run(ALSFRSR_file_allo_P2cont)
stat_allo_P12_LOCF = stat_table_run(ALSFRSR_file_allo_P12_LOCF)
stat_allo_P2cont_LOCF = stat_table_run(ALSFRSR_file_allo_P2cont_LOCF)
stat_allo_P12_FCSPMM = stat_table_run(ALSFRSR_file_allo_P12_FCSPMM)
stat_bind = cbind(stat_allo_P12,
stat_allo_P12_LOCF$pvalue,
stat_allo_P2cont$pvalue,
stat_allo_P2cont_LOCF$pvalue,
stat_allo_P12_FCSPMM$pvalue)
colnames(stat_bind) = c("TEST",
"P12_Allo",
"P12_Allo_LOCF",
"P2CONT_Allo",
"P2CONT_Allo_LOCF",
"P12_FCSPMM")
PMS_file = "./Data/Rawdata/PMS_V2.xlsx"
PMS_Phase12_change_slope = read_xlsx(ALSFRSR_file, sheet = 10)
#### 1. Library Loading ####
packs = c("data.table", "readxl", "ggpubr", "writexl")
lapply(packs, require, character.only = TRUE)
rm(packs)
#### 2. Files Loading ####
ALSFRSR_file = "./Data/Rawdata/Allo 및 임상 12상 통합자료.xlsx"
ALSFRSR_file_allo_P2cont = read_xlsx(ALSFRSR_file, sheet = 3)
ALSFRSR_file_allo_P12 = read_xlsx(ALSFRSR_file, sheet = 4)
ALSFRSR_file_allo_P12_FCSPMM = read_xlsx(ALSFRSR_file, sheet = 5)
PMS_file = "./Data/Rawdata/PMS_V2.xlsx"
PMS_Phase12_change_slope = read_xlsx(ALSFRSR_file, sheet = 10)
PMS_Phase12_change_slope = read_xlsx(PMS_file, sheet = 10)
View(PMS_Phase12_change_slope)
PMS_Phase12_change_slope = read_xlsx(PMS_file, sheet = 11)
View(PMS_Phase12_change_slope)
PMS_Phase12_change_slope = read_xlsx(PMS_file, sheet = 12)
View(PMS_Phase12_change_slope)
PMS_Phase12_change_slope = read_xlsx(PMS_file, sheet = 13)
View(PMS_Phase12_change_slope)
PMS_file = "./Data/Rawdata/PMS_V2.xlsx"
PMS_Phase12_change_slope = read_xlsx(PMS_file, sheet = 13)
PMS_ALSFRS_init_table = read_xlsx(PMS_file, sheet = 14)
View(PMS_ALSFRS_init_table)
PMS_file = "./Data/Rawdata/PMS_V2.xlsx"
PMS_Phase12_change_slope = read_xlsx(PMS_file, sheet = 13)
PMS_ALSFRS_init_table = read_xlsx(PMS_file, sheet = 14)
PMS_ALSFRS_table = read_xlsx(PMS_file, sheet = 15)
View(PMS_ALSFRS_table)
save.image(file = "./Data/ALS RMAT analysis files.image")
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
#### 2. info check ####
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 1)) #45
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 1)) #6
ALSFRSR_file_allo_P12$Changes = ALSFRSR_file_allo_P12$M12 - ALSFRSR_file_allo_P12$M0
ALSFRSR_file_allo_P2cont$Changes = ALSFRSR_file_allo_P2cont$M12 - ALSFRSR_file_allo_P2cont$M0
ALSFRSR_file_allo_P12_FCSPMM$Changes = ALSFRSR_file_allo_P12_FCSPMM$M12 - ALSFRSR_file_allo_P12_FCSPMM$M0
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
View(PMS_ALSFRS_table)
View(PMS_ALSFRS_init_table)
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
View(PMS_ALSFRS_table)
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
}
34-41
42075-41806
269/28
-7/9.70714
-7/9.60714
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
#### 2. info check ####
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 1)) #45
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 1)) #6
ALSFRSR_file_allo_P12$Changes = ALSFRSR_file_allo_P12$M12 - ALSFRSR_file_allo_P12$M0
ALSFRSR_file_allo_P2cont$Changes = ALSFRSR_file_allo_P2cont$M12 - ALSFRSR_file_allo_P2cont$M0
ALSFRSR_file_allo_P12_FCSPMM$Changes = ALSFRSR_file_allo_P12_FCSPMM$M12 - ALSFRSR_file_allo_P12_FCSPMM$M0
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_init_table[i,15] - PMS_ALSFRS_init_table[i,3]) /
12
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
#### 2. info check ####
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 1)) #45
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 1)) #6
ALSFRSR_file_allo_P12$Changes = ALSFRSR_file_allo_P12$M12 - ALSFRSR_file_allo_P12$M0
ALSFRSR_file_allo_P2cont$Changes = ALSFRSR_file_allo_P2cont$M12 - ALSFRSR_file_allo_P2cont$M0
ALSFRSR_file_allo_P12_FCSPMM$Changes = ALSFRSR_file_allo_P12_FCSPMM$M12 - ALSFRSR_file_allo_P12_FCSPMM$M0
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_init_table[i,15] - PMS_ALSFRS_init_table[i,3]) /
12
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,15] - PMS_ALSFRS_table[i,3]) /
12
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
colnames(PMS_ALSFRS_init_table)[18:20] = c("init_slope", "M12_slope","Change_of_slope")
wilcox.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope), subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope))
wilcox.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope
subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope
max(PMS_ALSFRS_table[i,14:16])
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
PMS_ALSFRS_init_table[i,19] = (max(PMS_ALSFRS_table[i,14:16]) - PMS_ALSFRS_table[i,3]) / 12
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
colnames(PMS_ALSFRS_init_table)[18:20] = c("init_slope", "M12_slope","Change_of_slope")
wilcox.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope
max(PMS_ALSFRS_table[i,14:16])
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
PMS_ALSFRS_init_table[i,19] = (max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
colnames(PMS_ALSFRS_init_table)[18:20] = c("init_slope", "M12_slope","Change_of_slope")
wilcox.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope
subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope
max(PMS_ALSFRS_table[i,14:16], na.rm = T)
is.na(PMS_ALSFRS_table[i,14:16])
sum(is.na(PMS_ALSFRS_table[i,14:16]))
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) != 3){
PMS_ALSFRS_init_table[i,19] = (max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
colnames(PMS_ALSFRS_init_table)[18:20] = c("init_slope", "M12_slope","Change_of_slope")
wilcox.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
#### 2. info check ####
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P12, GROUP == 1)) #45
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 0)) #27
nrow(subset(ALSFRSR_file_allo_P2cont, GROUP == 1)) #6
ALSFRSR_file_allo_P12$Changes = ALSFRSR_file_allo_P12$M12 - ALSFRSR_file_allo_P12$M0
ALSFRSR_file_allo_P2cont$Changes = ALSFRSR_file_allo_P2cont$M12 - ALSFRSR_file_allo_P2cont$M0
ALSFRSR_file_allo_P12_FCSPMM$Changes = ALSFRSR_file_allo_P12_FCSPMM$M12 - ALSFRSR_file_allo_P12_FCSPMM$M0
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) != 3){
PMS_ALSFRS_init_table[i,19] = (max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
PMS_ALSFRS_init_table[i,18:20] = NA
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) != 3){
PMS_ALSFRS_init_table[i,19] = (max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
PMS_ALSFRS_init_table[i,18:20] = NULL
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) != 3){
PMS_ALSFRS_init_table[i,19] = (max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
ALSFRSR_file_allo_P12$Changes = ALSFRSR_file_allo_P12$M12 - ALSFRSR_file_allo_P12$M0
ALSFRSR_file_allo_P2cont$Changes = ALSFRSR_file_allo_P2cont$M12 - ALSFRSR_file_allo_P2cont$M0
ALSFRSR_file_allo_P12_FCSPMM$Changes = ALSFRSR_file_allo_P12_FCSPMM$M12 - ALSFRSR_file_allo_P12_FCSPMM$M0
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
colnames(PMS_ALSFRS_init_table)[18:20] = c("init_slope", "M12_slope","Change_of_slope")
PMS_ALSFRS_init_table[i,18:20] = NULL
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(is.na(PMS_ALSFRS_table[i,14]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,14] - PMS_ALSFRS_table[i,3]) / 12
}else if(is.na(PMS_ALSFRS_table[i,15]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,15] - PMS_ALSFRS_table[i,3]) / 12
}else if(is.na(PMS_ALSFRS_table[i,16]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,16] - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
PMS_ALSFRS_init_table[1,18:20] = NA
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(is.na(PMS_ALSFRS_table[i,14]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,14] - PMS_ALSFRS_table[i,3]) / 12
}else if(is.na(PMS_ALSFRS_table[i,15]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,15] - PMS_ALSFRS_table[i,3]) / 12
}else if(is.na(PMS_ALSFRS_table[i,16]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,16] - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
PMS_ALSFRS_init_table[1,18:20] = 1
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(is.na(PMS_ALSFRS_table[i,14]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,14] - PMS_ALSFRS_table[i,3]) / 12
}else if(is.na(PMS_ALSFRS_table[i,15]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,15] - PMS_ALSFRS_table[i,3]) / 12
}else if(is.na(PMS_ALSFRS_table[i,16]) == F){
PMS_ALSFRS_init_table[i,19] = (PMS_ALSFRS_table[i,16] - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
(PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
i = 1
(PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
PMS_ALSFRS_table[i,14:16]
na.omit(PMS_ALSFRS_table[i,14:16])
length(na.omit(PMS_ALSFRS_table[i,14:16]))
sum(na.omit(PMS_ALSFRS_table[i,14:16]))
sum(is.na(PMS_ALSFRS_table[i,14:16]))
sum(is.na(PMS_ALSFRS_table[2,14:16]))
max(is.na(PMS_ALSFRS_table[2,14:16]))
max(PMS_ALSFRS_table[2,14:16])
max(PMS_ALSFRS_table[2,14:16], na.rm = T)
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) == 3){
PMS_ALSFRS_init_table[i,19] = NA
}else{
PMS_ALSFRS_init_table[i,19] = (max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
max(PMS_ALSFRS_table[i,14:16], na.rm = T)
PMS_ALSFRS_table[i,3]
(max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3])
(max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) == 3){
PMS_ALSFRS_init_table[i,19] = NA
}else{
PMS_ALSFRS_init_table[i,19] = as.numeric((max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12)
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
View(PMS_ALSFRS_init_table)
PMS_ALSFRS_init_table[i,18] = 1
PMS_ALSFRS_init_table[i,19] = 1
View(PMS_ALSFRS_init_table)
PMS_ALSFRS_init_table[,18] = 1
PMS_ALSFRS_init_table[,19] = 1
PMS_ALSFRS_init_table[,18] = as.nuemric(1)
PMS_ALSFRS_init_table[,19] = as.nuemric(1)
PMS_ALSFRS_init_table[,18] = as.numeric(1)
PMS_ALSFRS_init_table[,19] = as.numeric(1)
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) == 3){
PMS_ALSFRS_init_table[i,19] = NA
}else{
PMS_ALSFRS_init_table[i,19] = as.numeric((max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12)
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
colnames(PMS_ALSFRS_init_table)[18:20] = c("init_slope", "M12_slope","Change_of_slope")
wilcox.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
t.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
var.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope)
t.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope,
var.equal = T)
PMS_ALSFRS_init_table_Multi = subset(PMS_ALSFRS_init_table, INJ >=3)
PMS_ALSFRS_init_table_Normal = subset(PMS_ALSFRS_init_table, INJ < 3)
View(PMS_ALSFRS_init_table_Multi)
PMS_ALSFRS_init_table_Multi = PMS_ALSFRS_init_table_Multi[complete.cases(PMS_ALSFRS_init_table_Multi),c(2,20)]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[complete.cases(PMS_ALSFRS_init_table_Normal),c(2,20)]
View(PMS_ALSFRS_init_table_Normal)
View(PMS_ALSFRS_init_table_Multi)
View(PMS_ALSFRS_init_table_Multi)
subset(PMS_ALSFRS_init_table, INJ >= 3)$Change_of_slope
PMS_ALSFRS_init_table_Multi = subset(PMS_ALSFRS_init_table, INJ >=3)
PMS_ALSFRS_init_table_Normal = subset(PMS_ALSFRS_init_table, INJ < 3)
PMS_ALSFRS_init_table_Multi = PMS_ALSFRS_init_table_Multi[c(2,20)]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[,c(2,20)]
View(PMS_ALSFRS_init_table_Multi)
View(PMS_ALSFRS_init_table_Normal)
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[,c(2,20)]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[complete.cases(PMS_ALSFRS_init_table_Normal),]
View(PMS_ALSFRS_init_table_Normal)
row.names(PMS_ALSFRS_init_table_Multi) = 1:nrow(PMS_ALSFRS_init_table_Multi)
nrow(PMS_ALSFRS_init_table_Multi)
PMS_ALSFRS_init_table_Multi = PMS_ALSFRS_init_table_Multi[complete.cases(PMS_ALSFRS_init_table_Multi),]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[complete.cases(PMS_ALSFRS_init_table_Normal),]
View(PMS_ALSFRS_init_table_Multi)
View(PMS_ALSFRS_init_table_Normal)
PMS_ALSFRS_init_table_Multi = subset(PMS_ALSFRS_init_table, INJ >=3)
PMS_ALSFRS_init_table_Normal = subset(PMS_ALSFRS_init_table, INJ < 3)
PMS_ALSFRS_init_table_Multi = PMS_ALSFRS_init_table_Multi[c(2,3,20)]
PMS_ALSFRS_init_table_Multi = PMS_ALSFRS_init_table_Multi[complete.cases(PMS_ALSFRS_init_table_Multi),]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[,c(2,3,20)]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[complete.cases(PMS_ALSFRS_init_table_Normal),]
View(PMS_ALSFRS_init_table_Multi)
PMS_ALSFRS_init_table_Multi = subset(PMS_ALSFRS_init_table, INJ >=3)
PMS_ALSFRS_init_table_Normal = subset(PMS_ALSFRS_init_table, INJ < 3)
PMS_ALSFRS_init_table_Multi = PMS_ALSFRS_init_table_Multi[c(2,20)]
PMS_ALSFRS_init_table_Multi = PMS_ALSFRS_init_table_Multi[complete.cases(PMS_ALSFRS_init_table_Multi),]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[,c(2,20)]
PMS_ALSFRS_init_table_Normal = PMS_ALSFRS_init_table_Normal[complete.cases(PMS_ALSFRS_init_table_Normal),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[c(2,20)]
#### 1. source Loading ####
load("./Data/ALS RMAT analysis files.image")
source("./Script/Functions/ALS RMAT analysis - functions.R")
PMS_ALSFRS_table = PMS_ALSFRS_table[PMS_ALSFRS_table$SUBJ_ID %in% PMS_ALSFRS_init_table$SUBJ_ID,]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[PMS_ALSFRS_init_table$SUBJ_ID %in% PMS_ALSFRS_table$SUBJ_ID,]
PMS_ALSFRS_table = PMS_ALSFRS_table[order(PMS_ALSFRS_table$SUBJ_ID),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[order(PMS_ALSFRS_init_table$SUBJ_ID),]
PMS_ALSFRS_init_table[,18] = as.numeric(1)
PMS_ALSFRS_init_table[,19] = as.numeric(1)
for (i in 1:nrow(PMS_ALSFRS_init_table)){
PMS_ALSFRS_init_table[i,18] =  (PMS_ALSFRS_init_table[i,6] - PMS_ALSFRS_init_table[i,4]) /
((PMS_ALSFRS_init_table[i,7] - PMS_ALSFRS_init_table[i,5]) / 28)
if(sum(is.na(PMS_ALSFRS_table[i,14:16])) == 3){
PMS_ALSFRS_init_table[i,19] = NA
}else{
PMS_ALSFRS_init_table[i,19] = as.numeric((max(PMS_ALSFRS_table[i,14:16], na.rm = T) - PMS_ALSFRS_table[i,3]) / 12)
}
PMS_ALSFRS_init_table[i,20] = (PMS_ALSFRS_init_table[i,18] - PMS_ALSFRS_init_table[i,19])
}
colnames(PMS_ALSFRS_init_table)[18:20] = c("init_slope", "M12_slope","Change_of_slope")
t.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope,
var.equal = T)
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[c(2,3,20)]
PMS_ALSFRS_init_table$GROUP == ifelse(PMS_ALSFRS_init_table$INJ >= 3, "PMS_Multi", "PMS_Normal"))
PMS_ALSFRS_init_table$GROUP == ifelse(PMS_ALSFRS_init_table$INJ >= 3, "PMS_Multi", "PMS_Normal")
PMS_ALSFRS_init_table$GROUP = ifelse(PMS_ALSFRS_init_table$INJ >= 3, "PMS_Multi", "PMS_Normal")
View(PMS_ALSFRS_table)
View(PMS_ALSFRS_table)
View(PMS_ALSFRS_init_table_Normal)
PMS_ALSFRS_init_table
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[complete.cases(PMS_ALSFRS_init_table),]
PMS_ALSFRS_init_table = PMS_ALSFRS_init_table[,-2]
View(PMS_ALSFRS_init_table)
View(PMS_Phase12_change_slope)
wilcox.test(subset(PMS_ALSFRS_init_table, INJ >=3)$Change_of_slope, subset(PMS_ALSFRS_init_table, INJ < 3)$Change_of_slope,
var.equal = T)
ggboxplot(data = PMS_ALSFRS_init_table, x = "Change_of_slope", y = "GROUP")
ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope")
ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter")
ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", size = 3)
ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", size = 2, add.params = list(size = 2))
ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", add.params = list(size = 2))
ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", add.params = list(size = 2.5))
ggp = ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", add.params = list(size = 2.5))
ggp = ggp + compare_means(method = t.test, var.equal = TRUE)
ggp = ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", add.params = list(size = 2.5)) + stat_compare_means(method = "t.test",
method.args = list(var.equal = TRUE))
ggp
ggp = ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", add.params = list(size = 2.5)) + stat_compare_means(method = "wilcox.test",
method.args = list(var.equal = TRUE))
ggp
ggp = ggboxplot(data = PMS_ALSFRS_init_table, x = "GROUP", y = "Change_of_slope", color = "GROUP", add = "jitter",
xlab = "Group", ylab = "Change of ALSFRS-R slope", add.params = list(size = 2.5)) + stat_compare_means(method = "t.test",
method.args = list(var.equal = TRUE))
ggp
ggsave("./Output/PMS change of ALSFRS-R slope.tiff", width = "6", height = 6, units = "in", dpi = 300)
ggsave("./Output/PMS change of ALSFRS-R slope.tiff", width = 6, height = 6, units = "in", dpi = 300)
View(PMS_Phase12_change_slope)
mean(subset(PMS_Phase12_change_slope, GROUP == 0)$Change_of_ALSFRS_slope)
mean(subset(PMS_Phase12_change_slope, PMS_Phase12_change_slope$`GROUP
(0=placebo,1=trt)`)$Change_of_ALSFRS_slope)
mean(subset(PMS_Phase12_change_slope, PMS_Phase12_change_slope$`GROUP
(0=placebo,1=trt)` == 0 )$Change_of_ALSFRS_slope)
mean(subset(PMS_Phase12_change_slope, PMS_Phase12_change_slope$`GROUP
(0=placebo,1=trt)` == 0)$Change_of_ALSFRS_slope)
mean(PMS_Phase12_change_slope$Change_of_ALSFRS_slope[1:11])
mean(PMS_Phase12_change_slope$Change_of_ALSFRS_slope[12:26])
PMS_shortage_run = function(PMS_extended_data_table, type){
if(type == "DreamCIS"){
PMS_extended_data_table = PMS_extended_data_table[,c(1,10:21)]
}
}
PMS_shortage_run = function(PMS_extended_data_table, type){
if(type == "DreamCIS"){
PMS_extended_data_table = PMS_extended_data_table[,c(1,10:21)]
PMS_extended_data_table[,"ALSFRS_2nd"] =  PMS_extended_data_table[,"ALSFRS_2nd"] - PMS_extended_data_table[,"ALSFRS_1st"]
PMS_extended_data_table[,"ALSFRS_3rd"] =  PMS_extended_data_table[,"ALSFRS_3rd"] - PMS_extended_data_table[,"ALSFRS_1st"]
PMS_extended_data_table[,"ALSFRS_4th"] =  PMS_extended_data_table[,"ALSFRS_4th"] - PMS_extended_data_table[,"ALSFRS_1st"]
PMS_extended_data_table[,"ALSFRS_5th"] =  PMS_extended_data_table[,"ALSFRS_5th"] - PMS_extended_data_table[,"ALSFRS_1st"]
PMS_extended_data_table[,"ALSFRS_6th"] =  PMS_extended_data_table[,"ALSFRS_6th"] - PMS_extended_data_table[,"ALSFRS_1st"]
PMS_extended_data_table[,"ALSFRS_1st"] = 0
}
return(PMS_extended_data_table)
}
PMS_shortage_data_table = data.frame(NULL)
colnames(PMS_shortage_data_table) = c("subject_id",
"ALSFRS_Delta",
"ALSFRS_R_Total")
PMS_extended_data_table = PMS_data_table_DreamCIS
